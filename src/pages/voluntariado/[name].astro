---
import qs from "qs";

import VolunteeringLayout from "@/layouts/VolunteeringLayout.astro";
import type { About } from "@/interfaces/AboutSection";
import type { GetStaticPaths } from "astro";
import PrimaryButton from "@/components/shared/PrimaryButton.astro";

import volunteering from '@/assets/data/volunteering.json'
import BlogTextContent from "@/components/ui/BlogTextContent.astro";
import type { Volunteering } from "@/interfaces/Volunteering";
import { getVolunteerings } from "../api/volunteering";

export async function getStaticPaths() {
    const {body:volunteerings} = await getVolunteerings()
   
    /* const baseUrl = import.meta.env.STRAPI_URL + "/api/volunteerings";

    const query = qs.stringify({
    populate: {
      image: {
        fields: ["name", "width", "height", "url"],
      },
    },
  }, { encode: false });

  const url = `${baseUrl}?${query}`; 
  const data = await fetch(url)
    .then((response) => response.json())
    .catch((error) => {
      console.error("Error fetching posts:", error);
      return null;
    }); */

    return volunteerings.map((item:Volunteering) => ({
      params: { name: item.slug },
      props: { item },
    })) || [];
}


/* export const getStaticPaths = (() => {
    const staticPaths = volunteering.map((item) => (
        { params: {name: item.path}, props: {...item} }
    ))
    return staticPaths

}) satisfies GetStaticPaths; */

const {name} = Astro.params;
const {item: props} = Astro.props;
const {title, subtitle, slogan, paragraph, image, links} = props as Volunteering;
const url = import.meta.env.STRAPI_URL;
const volunteeringData = {title, subtitle, paragraph, image}

console.log("url Image", url+image)
---

<VolunteeringLayout {title}>   
    
    <!-- Book main info -->
    <BlogTextContent {...volunteeringData}>
        
        <!-- Image -->
        <div class=`h-[55vh] w-full` 
        style=`background: url(${url}${image.url}); background-size:cover;
        background-position-x: center; background-position-y: start; background-repeat: no-repeat`>
        </div>

        <!-- Slogan -->
        <h3 class="h3-hero mt-6 text-ocreNeutral-130 font-semibold" style="text-transform: none; letter-spacing: normal;">{slogan}</h3>

    </BlogTextContent>
    
</VolunteeringLayout>